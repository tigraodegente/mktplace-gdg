<!doctype html>
<html lang="pt-BR">
	<!-- Deploy seletivo - teste -->
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="%sveltekit.assets%/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		
		<!-- PWA Meta Tags -->
		<meta name="theme-color" content="#00BFB3" />
		<meta name="mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="default" />
		<meta name="apple-mobile-web-app-title" content="Marketplace GDG" />
		<link rel="apple-touch-icon" href="/icons/icon-192x192.png" />
		<link rel="manifest" href="/manifest.json" />
		
		<!-- OpenSearch -->
		<link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Buscar produtos no Marketplace GDG" />
		
		<!-- Google Fonts Preload -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link rel="preload" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
		<noscript>
			<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&display=swap">
		</noscript>
		
		<!-- Preload CSS crÃ­tico -->
		%sveltekit.head%
		
		<!-- Critical CSS inlined (serÃ¡ feito pelo build) -->
		<style>
			/* Critical CSS for layout stability */
			.loading-skeleton {
				background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
				background-size: 200% 100%;
				animation: loading 1.5s infinite;
			}
			@keyframes loading {
				0% { background-position: 200% 0; }
				100% { background-position: -200% 0; }
			}
		</style>

		<!-- Service Worker Registration (APENAS PRODUÃ‡ÃƒO) -->
		<script>
			// COMPLETAMENTE DESABILITADO EM LOCALHOST
			if ('serviceWorker' in navigator && window.location.hostname !== 'localhost') {
				window.addEventListener('load', async () => {
					try {
						const registration = await navigator.serviceWorker.register('/sw.js', {
							scope: '/',
							updateViaCache: 'imports'
						});
						console.log('ðŸŽ‰ Service Worker registrado:', registration.scope);
					} catch (error) {
						console.warn('Service Worker erro:', error);
					}
				});
			} else if (window.location.hostname === 'localhost') {
				console.log('ðŸš« Service Worker desabilitado em localhost');
			}
		</script>

		<!-- Analytics apenas em produÃ§Ã£o -->
		<script>
			if (window.location.hostname !== 'localhost') {
				// Google Analytics 4
				(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
				new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
				j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
				'https://www.googletagmanager.com/gtag/js?id='+i+dl;f.parentNode.insertBefore(j,f);
				})(window,document,'script','dataLayer','GA_MEASUREMENT_ID');
				
				window.dataLayer = window.dataLayer || [];
				function gtag(){dataLayer.push(arguments);}
				gtag('js', new Date());
				gtag('config', 'GA_MEASUREMENT_ID');
			}
		</script>
	</head>
	<body data-sveltekit-preload-data="hover" class="bg-white">
		<!-- App Shell -->
		<div style="display: contents">%sveltekit.body%</div>
		
		<!-- Chat Widget Container -->
		<div id="chat-widget-root"></div>
		
		<!-- Error Tracking (Development) -->
		<script>
			window.addEventListener('error', (e) => {
				console.error('ðŸš¨ Global Error:', e.error);
			});
			
			window.addEventListener('unhandledrejection', (e) => {
				console.error('ðŸš¨ Unhandled Promise:', e.reason);
			});
		</script>
	</body>
</html>
<!-- Deploy automÃ¡tico funcionando -->
